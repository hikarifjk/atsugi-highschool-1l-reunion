---
import Layout from '../layouts/Layout.astro';
import participants from '../data/participants.json';
import { getCollection } from 'astro:content';

const formUrl = 'https://example.com/google-form';
const latestNews = (await getCollection('news')).sort(
	(a, b) => b.data.date.getTime() - a.data.date.getTime(),
).slice(0, 5);

const dateFormatter = new Intl.DateTimeFormat('ja-JP', {
	year: 'numeric',
	month: '2-digit',
	day: '2-digit',
});
---

<Layout title="厚木高校1L 同窓会 | トップ">
	<section class="hero card">
		<h1>厚木高校1L 同窓会のご案内</h1>
		<p>
			久しぶりに集まって、近況を語り合う同窓会を企画しています。開催時期や会場の詳細は順次更新しますので、まずはフォームから連絡先の登録にご協力ください。
		</p>
		<a class="form-button" href={formUrl} target="_blank" rel="noopener noreferrer">Googleフォームで参加連絡</a>
	</section>

	<section class="section-block">
		<h2>最新情報</h2>
		<ul class="news-list">
			{
				latestNews.map((item) => (
					<li class="card">
						<p class="news-meta">{dateFormatter.format(item.data.date)}</p>
						<h3>{item.data.title}</h3>
						<p>{item.body}</p>
						{item.data.link && (
							<p><a class="text-link" href={item.data.link} target="_blank" rel="noopener noreferrer">関連リンクを見る</a></p>
						)}
					</li>
				))
			}
		</ul>
	</section>

	<section class="section-block">
		<h2>参加者紹介</h2>
		<div class="participants-grid">
			{
				participants.map((participant) => (
					<article class="card participant-card">
						<img src={participant.logo} alt={`${participant.name} ロゴ`} loading="lazy" />
						<h3>{participant.name}</h3>
						<p>{participant.intro}</p>
						<p><a class="text-link" href={participant.youtube} target="_blank" rel="noopener noreferrer">YouTubeチャンネル</a></p>
						{participant.link && (
							<p><a class="text-link" href={participant.link} target="_blank" rel="noopener noreferrer">関連リンク</a></p>
						)}
						<div class="tag-list">
							{participant.categories.map((category) => (
								<span class="tag">{category}</span>
							))}
						</div>
					</article>
				))
			}
		</div>
	</section>
</Layout>

<style>
	h1 {
		font-size: clamp(1.5rem, 3vw, 2rem);
		margin: 0 0 1rem;
	}

	h2 {
		margin: 0 0 1rem;
	}

	h3 {
		margin: 0.2rem 0 0.7rem;
		font-size: 1.1rem;
	}

	p {
		margin: 0 0 0.8rem;
		line-height: 1.7;
	}

	.section-block {
		margin-top: 2rem;
	}

	.card {
		background: #fff;
		border: 1px solid #d1d5db;
		border-radius: 12px;
		padding: 1rem;
	}

	.form-button {
		display: inline-block;
		background: #2563eb;
		color: #fff;
		text-decoration: none;
		font-weight: 700;
		padding: 0.9rem 1.5rem;
		border-radius: 10px;
		margin-top: 0.5rem;
	}

	.form-button:hover {
		background: #1d4ed8;
	}

	.news-list {
		list-style: none;
		padding: 0;
		margin: 0;
		display: grid;
		gap: 0.8rem;
	}

	.news-meta {
		font-size: 0.9rem;
		color: #6b7280;
		margin-bottom: 0.3rem;
	}

	.participants-grid {
		display: grid;
		grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
		gap: 1rem;
	}

	.participant-card img {
		width: 100%;
		height: auto;
		max-width: 160px;
		display: block;
		margin-bottom: 0.8rem;
	}

	.tag-list {
		display: flex;
		flex-wrap: wrap;
		gap: 0.4rem;
	}

	.tag {
		font-size: 0.8rem;
		background: #e5e7eb;
		padding: 0.2rem 0.6rem;
		border-radius: 999px;
	}

	.text-link {
		color: #2563eb;
	}
</style>
